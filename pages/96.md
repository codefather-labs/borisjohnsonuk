`        ` `asyncio` `.` `create_task` `(` `chan_sender` `(` `channel_name` `))` `  ` `      ` `await` ` ` `CHAN_QUEUES` `[` `channel_name` `]` `.` `put` `(` `data` `)` `  ` `  ` `except` ` ` `asyncio` `.` `CancelledError` `:` `    ` `print` `(` `f` `'Remote ` `{peername}` ` connection cancelled.'` `)` `  ` `except` ` ` `asyncio` `.` `IncompleteReadError` `:` `    ` `print` `(` `f` `'Remote ` `{peername}` ` disconnected'` `)` `  ` `finally` `:` `    ` `print` `(` `f` `'Remote ` `{peername}` ` closed'` `)` `    ` `await` ` ` `SEND_QUEUES` `[` `writer` `]` `.` `put` `(` `None` `)` `  ` `    ` `await` ` ` `send_task` `  ` `    ` `del` ` ` `SEND_QUEUES` `[` `writer` `]` `  ` `    ` `SUBSCRIBERS` `[` `subscribe_chan` `]` `.` `remove` `(` `writer` `)` `async` ` ` `def` ` ` `send_client` `(` `writer` `:` ` ` `StreamWriter` `,` ` ` `queue` `:` ` ` `Queue` `):` `  ` `    ` `while` ` ` `True` `:` `        ` `try` `:` `            ` `data` ` ` `=` ` ` `await` ` ` `queue` `.` `get` `()` `        ` `except` ` ` `asyncio` `.` `CancelledError` `:` `            ` `continue` `        ` `if` ` ` `not` ` ` `data` `:` `            ` `break` `        ` `try` `:` `            ` `await` ` ` `send_msg` `(` `writer` `,` ` ` `data` `)` `        ` `except` ` ` `asyncio` `.` `CancelledError` `:` `            ` `await` ` ` `send_msg` `(` `writer` `,` ` ` `data` `)` `    ` `writer` `.` `close` `()` `    ` `await` ` ` `writer` `.` `wait_closed` `()` `async` ` ` `def` ` ` `chan_sender` `(` `name` `:` ` ` `bytes` `):` `    ` `with` ` ` `suppress` `(` `asyncio` `.` `CancelledError` `):` `        ` `while` ` ` `True` `:` `            ` `writers` ` ` `=` ` ` `SUBSCRIBERS` `[` `name` `]` `            ` `if` ` ` `not` ` ` `writers` `:` `                ` `await` ` ` `asyncio` `.` `sleep` `(` `1` `)` `                ` `continue` `  ` `            ` `if` ` ` `name` `.` `startswith` `(` `b` `'/queue'` `):` `  ` `                ` `writers` `.` `rotate` `()` `                ` `writers` ` ` `=` ` ` `[` `writers` `[` `0` `]]` `            ` `if` ` ` `not` ` ` `(` `msg` ` ` `:` `=` ` ` `await` ` ` `CHAN_QUEUES` `[` `name` `]` `.` `get` `()):` ` ` `                ` `break` `            ` `for` ` ` `writer` ` ` `in` ` ` `writers` `:` `                ` `if` ` ` `not` ` ` `SEND_QUEUES` `[` `writer` `]` `.` `full` `():` `                    ` `print` `(` `f` `'Sending to ` `{name}` `: ` `{msg[:19]}` `...'` `)` `                    ` `await` ` ` `SEND_QUEUES` `[` `writer` `]` `.` `put` `(` `msg` `)` `  ` `async` ` ` `def` ` ` `main` `(` `*` `args` `,` ` ` `**` `kwargs` `):` `    ` `server` ` ` `=` ` ` `await` ` ` `asyncio` `.` `start_server` `(` `*` `args` `,` ` ` `**` `kwargs` `)` `    ` `async` ` ` `with` ` ` `server` `:` `        ` `await` ` ` `server` `.` `serve_forever` `()` **Streams (Standard Library) ** **| ** **85**