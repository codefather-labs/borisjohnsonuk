Example: Implementing the “Almost-Equal” Operator You can now program the behaviour of almost-equal to match the following scenario: •  1 ~= 2  is  False •  1 ~= 1.01  is  True , using floor-rounding We can achieve this with some additional code. For now, you will cast both floats into integers and compare them. CPython’s API has many functions for dealing with PyLong ( int ) and PyFloat  ( float ) types. This will be covered in the chapter on Objects and Types. Locate the  float_richcompare()  in  Objects floatobject.c , and under the Compare:  goto deﬁnition add the following case: Objects floatobject.c  line 358 static  PyObject* float_richcompare(PyObject *v, PyObject *w,  int  op) { ... case  Py_GT: r = i > j; break ; /* New Code START */ case  Py_AlE: { double  diff = fabs(i - j); double  rel_tol =  1e-9 ;  // relative tolerance double  abs_tol =  0.1 ; // absolute tolerance r = (((diff <= fabs(rel_tol * j)) || (diff <= fabs(rel_tol * i))) || (diff <= abs_tol)); } break ; } /* New Code  END  */ return  PyBool_FromLong(r); 151