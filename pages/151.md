`    ` `<h1>` `CPU (%)` `</h1>` `    ` `<canvas` ` ` `id=` `"cpu_chart"` ` ` `style=` `"width:100%; height:300px"` `>` `    ` `</canvas>` `    ` `<hr>` `    ` `<h1>` `Memory usage (MB)` `</h1>` `    ` `<canvas` ` ` `id=` `"mem_chart"` ` ` `style=` `"width:100%; height:300px"` `>` `    ` `</canvas>` `cpu`  and  `mem`  are each a mapping of a color to a  `TimeSeries()`  instance. One chart instance is created for CPU, and one for memory usage. We create a  `TimeSeries()`  instance  *inside*  the  `onmessage`  event of the `EventSource()`  instance. This means that any new data coming in (e.g., on a different color name) will automatically get a new time series created for it. The `add_timeseries()`  function creates the  `TimeSeries()`  instance and adds to the given chart instance. Create a new  `EventSource()`  instance on the  */feed*  URL. The browser will connect to this endpoint on our server, ( *metric_server.py* ). Note that the browser will automatically try to reconnect if the connection is lost. Server-sent events are often overlooked, but in many situations their simplicity makes them preferable to WebSockets. The  `onmessage`  event will fire every time the server sends data. Here the data is parsed as JSON. Recall that the  `cpu`  identifier is a mapping of a color to a  `TimeSeries()`  instance. Here, we obtain that time series and append data to it. We also obtain the timestamp and parse it to get the correct format required by the chart. ### Database Trigger Handling for the asyncpg Case Study
 In  “Case Study: Cache Invalidation” on page 115 , one of the required Python source files was omitted in the interest of saving space. That file is presented in  Example B-4 . *Example B-4. triggers.py* `# triggers.py` `from` ` ` `asyncpg.connection` ` ` `import` ` ` `Connection` `  ` `async` ` ` `def` ` ` `create_notify_trigger` `(` `  ` `        ` `conn` `:` ` ` `Connection` `,` `        ` `trigger_name` `:` ` ` `str` ` ` `=` ` ` `'table_update_notify'` `,` `        ` `channel` `:` ` ` `str` ` ` `=` ` ` `'table_change'` `)` ` ` `->` ` ` `None` `:` `    ` `await` ` ` `conn` `.` `execute` `(` **140 ** **| ** **Appendix B: Supplementary Material**