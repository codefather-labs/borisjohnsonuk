2  The recipe for this dish, and recipes for other fine Spam-based fare, can be found  on the UKTV website . `asyncpg`  already has support for the  `LISTEN` / `NOTIFY`  API. This feature of PostgreSQL allows your app to subscribe to events on a named channel and to post events to named channels. PostgreSQL can almost become a lighter version of  RabbitMQ  or ActiveMQ ! This case study has more moving parts than usual, and that makes it awkward to present in the usual linear format. Instead, we’ll begin by looking at the final product, and work backward toward the underlying implementation. Our app provides a JSON-based API server for managing the favorite dishes of patrons at our robotic restaurant. The backing database will have only one table, `patron` , with only two fields:  `name`  and  `fav_dish` . Our API will allow the usual set of four operations:  *create* ,  *read* ,  *update* , and  *delete*  (CRUD). The following is a sample interaction with our API using  `curl` , illustrating how to create a new entry in our database (I haven’t yet shown how to start up the server running on  *localhost:8000* ; that will come later): `$ curl -d '{"name": "Carol", "fav_dish": "SPAM Bruschetta"}' \` `    -H "Content-Type: application/json" \` `    -X POST \` `    http://localhost:8000/patron` `{"msg":"ok","id":37}` The  `-d`  parameter is for data, 2   `-H`  is for the HTTP headers,  `-X`  is for the HTTP request method (alternatives include  `GET` ,  `DELETE` ,  `PUT` , and a few others), and the URL is for our API server. We’ll get to the code for that shortly. In the output, we see that the creation was  `ok` , and the  `id`  being returned is the primary key of the new record in the database. In the next few shell snippets, we’ll run through the other three operations:  *read* , *update* , and  *delete* . We can read the patron record we just created with this command: `$ curl -X GET http://localhost:8000/patron/37` `{"id":37,"name":"Carol","fav_dish":"SPAM Bruschetta"}` Reading the data is pretty straightforward. Note that the  `id`  of the desired record must be supplied in the URL. **116 ** **| ** **Chapter 4: 20 Asyncio Libraries You Aren’t Using (But…Oh, Never Mind)**