The channel to subscribe to is an input parameter, captured in  `args.listen` . Encode it into bytes before sending. By our protocol rules (as discussed in the broker code analysis previously), the first thing to do after connecting is to send the channel name to subscribe to. This loop does nothing else but wait for data to appear on the socket. The command-line arguments for this program make it easy to point to a host, a port, and a channel name to listen to. The code for the other client, the sender program shown in  Example 4-4 , is similar in structure to the listener module. *Example 4-4. Sender: a toolkit for sending data to our message broker* `# mq_client_sender.py` `import` ` ` `asyncio` `import` ` ` `argparse` `,` ` ` `uuid` `from` ` ` `itertools` ` ` `import` ` ` `count` `from` ` ` `msgproto` ` ` `import` ` ` `send_msg` `async` ` ` `def` ` ` `main` `(` `args` `):` `    ` `me` ` ` `=` ` ` `uuid` `.` `uuid4` `()` `.` `hex` `[:` `8` `]` `  ` `    ` `print` `(` `f` `'Starting up ` `{me}` `'` `)` `    ` `reader` `,` ` ` `writer` ` ` `=` ` ` `await` ` ` `asyncio` `.` `open_connection` `(` `        ` `host` `=` `args` `.` `host` `,` ` ` `port` `=` `args` `.` `port` `)` `  ` `    ` `print` `(` `f` `'I am {writer.get_extra_info("sockname")}'` `)` `    ` `channel` ` ` `=` ` b` `'/null'` `  ` `    ` `await` ` ` `send_msg` `(` `writer` `,` ` ` `channel` `)` ` ` `    ` `chan` ` ` `=` ` ` `args` `.` `channel` `.` `encode` `()` `  ` `    ` `try` `:` `        ` `for` ` ` `i` ` ` `in` ` ` `count` `():` `  ` `            ` `await` ` ` `asyncio` `.` `sleep` `(` `args` `.` `interval` `)` `  ` `            ` `data` ` ` `=` ` b` `'X'` `*` `args` `.` `size` ` ` `or` ` ` `f` `'Msg ` `{i}` ` from ` `{me}` `'` `.` `encode` `()` `            ` `try` `:` `                ` `await` ` ` `send_msg` `(` `writer` `,` ` ` `chan` `)` `                ` `await` ` ` `send_msg` `(` `writer` `,` ` ` `data` `)` ` ` `            ` `except` ` ` `OSError` `:` `                ` `print` `(` `'Connection ended.'` `)` `                ` `break` `    ` `except` ` ` `asyncio` `.` `CancelledError` `:` `        ` `writer` `.` `close` `()` `        ` `await` ` ` `writer` `.` `wait_closed` `()` `if` ` ` `__name__` ` ` `==` ` ` `'__main__'` `:` `  ` `parser` ` ` `=` ` ` `argparse` `.` `ArgumentParser` `()` `  ` **Streams (Standard Library) ** **| ** **81**